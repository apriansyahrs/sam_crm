{"openapi":"3.1.0","info":{"title":"SAM","version":"0.0.1"},"servers":[{"url":"http:\/\/sam_crm.test\/api"}],"paths":{"\/lead":{"post":{"operationId":"lead.create","tags":["Lead"],"responses":{"200":{"description":"","content":{"application\/json":{"schema":{"type":"string"}}}},"401":{"$ref":"#\/components\/responses\/AuthenticationException"}}}},"\/lead\/update":{"post":{"operationId":"lead.update","tags":["Lead"],"requestBody":{"content":{"application\/json":{"schema":{"type":"object","properties":{"id":{"type":"string"},"noktp":{"type":"string"}},"required":["id","noktp"]}}}},"responses":{"200":{"description":"","content":{"application\/json":{"schema":{"type":"string"}}}},"422":{"$ref":"#\/components\/responses\/ValidationException"},"401":{"$ref":"#\/components\/responses\/AuthenticationException"}}}},"\/noo\/getbu":{"get":{"operationId":"noo.getbu","tags":["Noo"],"responses":{"200":{"description":"","content":{"application\/json":{"schema":{"type":"string"}}}},"401":{"$ref":"#\/components\/responses\/AuthenticationException"}}}},"\/noo\/getdiv":{"get":{"operationId":"noo.getdiv","tags":["Noo"],"responses":{"200":{"description":"","content":{"application\/json":{"schema":{"type":"string"}}}},"401":{"$ref":"#\/components\/responses\/AuthenticationException"}}}},"\/noo\/getreg":{"get":{"operationId":"noo.getreg","tags":["Noo"],"responses":{"200":{"description":"","content":{"application\/json":{"schema":{"type":"string"}}}},"401":{"$ref":"#\/components\/responses\/AuthenticationException"}}}},"\/noo\/getclus":{"get":{"operationId":"noo.getclus","tags":["Noo"],"responses":{"200":{"description":"","content":{"application\/json":{"schema":{"type":"string"}}}},"401":{"$ref":"#\/components\/responses\/AuthenticationException"}}}},"\/noo":{"post":{"operationId":"noo.submit","tags":["Noo"],"responses":{"200":{"description":"","content":{"application\/json":{"schema":{"type":"string"}}}},"401":{"$ref":"#\/components\/responses\/AuthenticationException"}}},"get":{"operationId":"noo.fetch","tags":["Noo"],"responses":{"200":{"description":"","content":{"application\/json":{"schema":{"type":"string"}}}},"401":{"$ref":"#\/components\/responses\/AuthenticationException"}}}},"\/noo\/all":{"get":{"operationId":"noo.all","tags":["Noo"],"responses":{"200":{"description":"","content":{"application\/json":{"schema":{"type":"string"}}}},"401":{"$ref":"#\/components\/responses\/AuthenticationException"}}}},"\/noo\/{kodeOutlet}":{"get":{"operationId":"noo.singleOutlet","tags":["Noo"],"parameters":[{"name":"kodeOutlet","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"","content":{"application\/json":{"schema":{"type":"string"}}}},"401":{"$ref":"#\/components\/responses\/AuthenticationException"}}}},"\/nooOutlet":{"get":{"operationId":"noo.getnoooutlet","tags":["Noo"],"responses":{"200":{"description":"","content":{"application\/json":{"schema":{"type":"string"}}}},"401":{"$ref":"#\/components\/responses\/AuthenticationException"}}}},"\/noo\/confirm":{"post":{"operationId":"noo.confirm","tags":["Noo"],"requestBody":{"content":{"application\/json":{"schema":{"type":"object","properties":{"id":{"type":"string"},"status":{"type":"string"},"limit":{"type":"string"},"kode_outlet":{"type":"string"}},"required":["id","status","limit","kode_outlet"]}}}},"responses":{"200":{"description":"","content":{"application\/json":{"schema":{"type":"string"}}}},"422":{"$ref":"#\/components\/responses\/ValidationException"},"401":{"$ref":"#\/components\/responses\/AuthenticationException"}}}},"\/noo\/approved":{"post":{"operationId":"noo.approved","tags":["Noo"],"requestBody":{"content":{"application\/json":{"schema":{"type":"object","properties":{"id":{"type":"string"},"status":{"type":"string"}},"required":["id","status"]}}}},"responses":{"200":{"description":"","content":{"application\/json":{"schema":{"type":"string"}}}},"422":{"$ref":"#\/components\/responses\/ValidationException"},"401":{"$ref":"#\/components\/responses\/AuthenticationException"}}}},"\/noo\/reject":{"post":{"operationId":"noo.reject","tags":["Noo"],"requestBody":{"content":{"application\/json":{"schema":{"type":"object","properties":{"id":{"type":"string"},"status":{"type":"string"},"alasan":{"type":"string"}},"required":["id","status","alasan"]}}}},"responses":{"200":{"description":"","content":{"application\/json":{"schema":{"type":"string"}}}},"422":{"$ref":"#\/components\/responses\/ValidationException"},"401":{"$ref":"#\/components\/responses\/AuthenticationException"}}}},"\/outlet":{"get":{"operationId":"outlet.fetch","tags":["Outlet"],"responses":{"200":{"description":"","content":{"application\/json":{"schema":{"type":"string"}}}},"401":{"$ref":"#\/components\/responses\/AuthenticationException"}}},"post":{"operationId":"outlet.updatefoto","tags":["Outlet"],"requestBody":{"content":{"application\/json":{"schema":{"type":"object","properties":{"kode_outlet":{"type":"string"},"nama_pemilik_outlet":{"type":"string"},"nomer_tlp_outlet":{"type":"string"},"latlong":{"type":"string"}},"required":["kode_outlet","nama_pemilik_outlet","nomer_tlp_outlet","latlong"]}}}},"responses":{"200":{"description":"","content":{"application\/json":{"schema":{"type":"string"}}}},"422":{"$ref":"#\/components\/responses\/ValidationException"},"401":{"$ref":"#\/components\/responses\/AuthenticationException"}}}},"\/outlet\/{nama}":{"get":{"operationId":"outlet.singleOutlet","tags":["Outlet"],"parameters":[{"name":"nama","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"","content":{"application\/json":{"schema":{"type":"string"}}}},"401":{"$ref":"#\/components\/responses\/AuthenticationException"}}}},"\/planvisit":{"get":{"operationId":"planVisit.fetch","tags":["PlanVisit"],"responses":{"200":{"description":"","content":{"application\/json":{"schema":{"type":"string"}}}},"401":{"$ref":"#\/components\/responses\/AuthenticationException"}}},"post":{"operationId":"planVisit.add","tags":["PlanVisit"],"requestBody":{"content":{"application\/json":{"schema":{"type":"object","properties":{"tanggal_visit":{"type":"string"},"kode_outlet":{"type":"string"}},"required":["tanggal_visit","kode_outlet"]}}}},"responses":{"200":{"description":"","content":{"application\/json":{"schema":{"type":"string"}}}},"422":{"$ref":"#\/components\/responses\/ValidationException"},"401":{"$ref":"#\/components\/responses\/AuthenticationException"}}},"delete":{"operationId":"planVisit.delete","tags":["PlanVisit"],"parameters":[{"name":"bulan","in":"query","required":true,"schema":{"type":"string"}},{"name":"tahun","in":"query","required":true,"schema":{"type":"string"}},{"name":"kode_outlet","in":"query","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"","content":{"application\/json":{"schema":{"type":"string"}}}},"422":{"$ref":"#\/components\/responses\/ValidationException"},"401":{"$ref":"#\/components\/responses\/AuthenticationException"}}}},"\/planvisit\/filter":{"get":{"operationId":"planVisit.bymonth","tags":["PlanVisit"],"parameters":[{"name":"bulan","in":"query","required":true,"schema":{"type":"string"}},{"name":"tahun","in":"query","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"","content":{"application\/json":{"schema":{"type":"string"}}}},"422":{"$ref":"#\/components\/responses\/ValidationException"},"401":{"$ref":"#\/components\/responses\/AuthenticationException"}}}},"\/planvisitrealme":{"delete":{"operationId":"planVisit.deleterealme","tags":["PlanVisit"],"parameters":[{"name":"id","in":"query","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"","content":{"application\/json":{"schema":{"type":"string"}}}},"422":{"$ref":"#\/components\/responses\/ValidationException"},"401":{"$ref":"#\/components\/responses\/AuthenticationException"}}}},"\/planvisitnoo":{"get":{"operationId":"planVisit.fetchnoo","tags":["PlanVisit"]},"delete":{"operationId":"planVisit.deletenoo","tags":["PlanVisit"],"parameters":[{"name":"bulan","in":"query","required":true,"schema":{"type":"string"}},{"name":"tahun","in":"query","required":true,"schema":{"type":"string"}},{"name":"kode_outlet","in":"query","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"","content":{"application\/json":{"schema":{"type":"string"}}}},"422":{"$ref":"#\/components\/responses\/ValidationException"},"401":{"$ref":"#\/components\/responses\/AuthenticationException"}}}},"\/user":{"get":{"operationId":"user.fetch","summary":"Fetch user profile with relationships","tags":["User"],"responses":{"200":{"description":"","content":{"application\/json":{"schema":{"type":"string"}}}},"401":{"$ref":"#\/components\/responses\/AuthenticationException"}}}},"\/logout":{"post":{"operationId":"user.logout","summary":"Logout user by revoking token","tags":["User"],"responses":{"200":{"description":"","content":{"application\/json":{"schema":{"type":"string"}}}},"401":{"$ref":"#\/components\/responses\/AuthenticationException"}}}},"\/user\/register":{"post":{"operationId":"user.register","summary":"Register new user","tags":["User"],"requestBody":{"content":{"application\/json":{"schema":{"type":"object","properties":{"username":{"type":"string","description":"Username for login.","example":"soleh123456"},"name":{"type":"string","description":"Full name of the user.","example":"Soleh Somad"},"region":{"type":"string","description":"Region of the user.","example":"Jogja"},"cluster_id":{"type":"integer","description":"Cluster ID.","example":1},"password":{"type":"string","description":"Password for login.","example":"janggut123"},"password_confirmation":{"type":"string","minLength":8}},"required":["username","name","region","cluster_id","password","password_confirmation"]}}}},"responses":{"200":{"description":"","content":{"application\/json":{"schema":{"type":"string"}}}},"422":{"$ref":"#\/components\/responses\/ValidationException"}}}},"\/user\/login":{"post":{"operationId":"user.login","summary":"Handle user login","tags":["User"],"requestBody":{"content":{"application\/json":{"schema":{"type":"object","properties":{"version":{"type":"string","description":"Version of the app.","example":"1.0.3"},"username":{"type":"string","description":"Username for login.","example":"adiasm"},"password":{"type":"string","description":"Password for login.","example":"complete123"},"notif_id":{"type":"string","description":"Notification ID for push notifications.","example":"68a4636e-c000-4dbf-bff9-c374e4a8c5ff"}},"required":["version","username","password","notif_id"]}}}},"responses":{"200":{"description":"","content":{"application\/json":{"schema":{"type":"string"}}}},"422":{"$ref":"#\/components\/responses\/ValidationException"}}}},"\/visit":{"get":{"operationId":"visit.fetch","tags":["Visit"],"responses":{"200":{"description":"","content":{"application\/json":{"schema":{"type":"string"}}}},"401":{"$ref":"#\/components\/responses\/AuthenticationException"}}},"post":{"operationId":"visit.submit","tags":["Visit"],"requestBody":{"content":{"application\/json":{"schema":{"type":"object","properties":{"kode_outlet":{"type":"string"},"picture_visit":{"type":"string"},"latlong_in":{"type":"string"},"tipe_visit":{"type":"string"}},"required":["kode_outlet","picture_visit","latlong_in","tipe_visit"]}}}},"responses":{"200":{"description":"","content":{"application\/json":{"schema":{"type":"string"}}}},"422":{"$ref":"#\/components\/responses\/ValidationException"},"401":{"$ref":"#\/components\/responses\/AuthenticationException"}}}},"\/visit\/check":{"get":{"operationId":"visit.check","tags":["Visit"],"parameters":[{"name":"kode_outlet","in":"query","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"$outlet = Outlet::where('kode_outlet', $request->kode_outlet)->first();\n$outletId = $outlet->id;\nif ($lastDataVisit) {\nif ($lastDataVisit->durasi_visit) {\n$isExistingLastDurasi = true;\n}\n$isExistingLastDurasi = false;\n} else {\n$isExistingLastDurasi = false;\n}\n#kalau belum ada durasi maka bernilai true\nif (!$isExistingLastDurasi) {\n##kalau ada histori outlet tersebut di hari ini maka bernilai true\nif($lastDataSelectedOutletVisit)\n{\n##kalau outlet tersebut sudah ada durasi visit bernilai true\nif($lastDataSelectedOutletVisit->durasi_visit)\n{\nreturn ResponseFormatter::error([\n'data' => 'anda sudah checkout'\n],'anda hari ini sudah check out di outlet '.$lastDataSelectedOutletVisit->outlet->kode_outlet,400);\n}\n}\n##cek data last visit hari ini bernilai true jika ada\nelse\nif ($lastDataVisit) {\n##cek dari data terkahir visit apakah ada durasi visit dan sama outlet id nya dengan yang dikirim jika keduanya salah maka bernilai true\nif ($lastDataVisit->durasi_visit == null && $lastDataVisit->outlet_id != $outletId) {\nreturn ResponseFormatter::error([\n'message' => 'error'\n], \"Belum check out dari outlet \" . $lastDataVisit->outlet->kode_outlet, 400);\n} else {\nif ($lastDataVisit->outlet_id == $outletId) {\nreturn ResponseFormatter::success(null, 'ok');\n}\n##jika belum ci dimanapun\nreturn  ResponseFormatter::error([\n'data' => 'anda belum checkin'\n], 'anda belum check in di outlet manapun ', 400);\n}\n}\n} else {\n##jika belum ci dimanapun\nreturn  ResponseFormatter::error([\n'data' => 'anda belum checkin'\n], 'anda belum check in di outlet manapun ', 400);\n}","content":{"application\/json":{"schema":{"type":"string"}}}},"422":{"$ref":"#\/components\/responses\/ValidationException"},"401":{"$ref":"#\/components\/responses\/AuthenticationException"}}}},"\/visit\/monitor":{"get":{"operationId":"visit.monitor","tags":["Visit"],"responses":{"200":{"description":"","content":{"application\/json":{"schema":{"type":"string"}}}},"401":{"$ref":"#\/components\/responses\/AuthenticationException"}}}},"\/visitNoo":{"post":{"operationId":"visit.submitNoo","tags":["Visit"],"requestBody":{"content":{"application\/json":{"schema":{"type":"object","properties":{"kode_outlet":{"type":"string"},"picture_visit":{"type":"string"},"latlong_in":{"type":"string"},"tipe_visit":{"type":"string"}},"required":["kode_outlet","picture_visit","latlong_in","tipe_visit"]}}}},"responses":{"200":{"description":"","content":{"application\/json":{"schema":{"type":"string"}}}},"422":{"$ref":"#\/components\/responses\/ValidationException"},"401":{"$ref":"#\/components\/responses\/AuthenticationException"}}}}},"components":{"responses":{"AuthenticationException":{"description":"Unauthenticated","content":{"application\/json":{"schema":{"type":"object","properties":{"message":{"type":"string","description":"Error overview."}},"required":["message"]}}}},"ValidationException":{"description":"Validation error","content":{"application\/json":{"schema":{"type":"object","properties":{"message":{"type":"string","description":"Errors overview."},"errors":{"type":"object","description":"A detailed description of each field that failed validation.","additionalProperties":{"type":"array","items":{"type":"string"}}}},"required":["message","errors"]}}}}}}}